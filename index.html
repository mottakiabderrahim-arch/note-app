<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>Ù…ÙÙƒØ±ØªÙŠ</title>

<style>
body{
    margin:0;
    font-family:sans-serif;
    background:#f5f5f5;
}
body.dark{
    background:#121212;
    color:white;
}

.container{
    max-width:600px;
    margin:auto;
    padding:8px;
}

/* Ø§Ù„ØµÙØ­Ø§Øª */
#home,#editor,#settings{padding:5px}
#editor,#settings{display:none}

/* Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø§Øª */
.note{
    background:white;
    padding:8px;
    margin-bottom:8px;
    border-radius:6px;
    cursor:pointer;
}
.note small{color:gray}

body.dark .note,
body.dark #text,
body.dark input,
body.dark #menu,
body.dark #settings{
    background:#1e1e1e;
    color:white;
}

/* inputs */
input,button{
    padding:8px;
    font-size:15px;
    width:100%;
    margin-bottom:8px;
}

/* Ù†Øµ Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø© */
#text{
    min-height:35vh;
    border:1px solid #ddd;
    border-radius:6px;
    padding:10px;
    background:white;
    outline:none;
}

/* Ø§Ù„Ø£Ø²Ø±Ø§Ø± */
#actions{
    display:flex;
    gap:8px;
}
#actions button{flex:1}

/* Ø²Ø± + */
#add{
    position:fixed;
    bottom:15px;
    right:15px;
    width:48px;
    height:48px;
    border-radius:50%;
    font-size:26px;
    background:#e53935;
    color:white;
    border:none;
}

/* Ø£Ø¯ÙˆØ§Øª Ø§Ù„ØªÙ„ÙˆÙŠÙ† */
#tools{
    display:flex;
    justify-content:center;
    gap:12px;
}
.color{
    width:22px;
    height:22px;
    border-radius:50%;
    cursor:pointer;
    border:2px solid #ccc;
}
.color.active{border:3px solid #000}

/* 3 Ù†Ù‚Ø§Ø· */
#menuBtn{
    position:fixed;
    top:10px;
    right:10px;
    font-size:22px;
    cursor:pointer;
    z-index:1000;
}
#menu{
    position:fixed;
    top:40px;
    right:10px;
    background:white;
    border-radius:6px;
    box-shadow:0 2px 6px rgba(0,0,0,.2);
    display:none;
    z-index:1000;
}
#menu div{
    padding:10px;
    cursor:pointer;
}

/* Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª */
#settings h3{text-align:center}

/* Ø±Ù…Ø² Ø§Ù„Ø­Ù…Ø§ÙŠØ© */
#lockBox{display:none}
</style>
</head>

<body>

<div id="menuBtn" onclick="toggleMenu()">â‹®</div>
<div id="menu">
    <div onclick="toggleDark()">ğŸŒ™ Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù„ÙŠÙ„ÙŠ</div>
    <div onclick="toggleLock()">ğŸ” Ø±Ù…Ø² Ø§Ù„Ø­Ù…Ø§ÙŠØ©</div>
    <div onclick="openSettings()">âš™ï¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</div>
    <div onclick="backup()">â™»ï¸ Ù†Ø³Ø® Ø§Ø­ØªÙŠØ§Ø·ÙŠ</div>
    <div onclick="restore()">â™»ï¸ Ø§Ø³ØªØ±Ø¬Ø§Ø¹ Ø§Ù„Ù†Ø³Ø®Ø©</div>
    <div onclick="deleteAll()">ğŸ—‘ï¸ Ø­Ø°Ù Ø§Ù„ÙƒÙ„</div>
    <div onclick="about()">â„¹ï¸ Ø­ÙˆÙ„</div>
</div>

<div class="container">

<div id="lockBox">
    <input id="pin" type="password" placeholder="Ø£Ø¯Ø®Ù„ Ø§Ù„Ø±Ù…Ø²">
    <button onclick="savePin()">Ø­ÙØ¸ Ø§Ù„Ø±Ù…Ø²</button>
</div>

<div id="home">
    <input id="search" placeholder="Ø¨Ø­Ø«...">
    <div id="notesList"></div>
</div>

<div id="editor">
    <input id="title" placeholder="Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø©">
    <div id="text" contenteditable="true"></div>

    <div id="actions">
        <button onclick="saveNote()">Ø­ÙØ¸</button>
        <button onclick="deleteNote()">Ø­Ø°Ù</button>
        <button onclick="back()">Ø±Ø¬ÙˆØ¹</button>
    </div>

    <div id="tools">
        <div class="color" data-color="black" style="background:black"></div>
        <div class="color" data-color="red" style="background:red"></div>
        <div class="color" data-color="blue" style="background:blue"></div>
        <div class="color" data-color="green" style="background:green"></div>
    </div>
</div>

<div id="settings">
    <h3>âš™ï¸ Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª</h3>
    <button onclick="changeFont(1)">â• ØªÙƒØ¨ÙŠØ± Ø§Ù„Ø®Ø·</button>
    <button onclick="changeFont(-1)">â– ØªØµØºÙŠØ± Ø§Ù„Ø®Ø·</button>
    <button onclick="back()">â¬…ï¸ Ø±Ø¬ÙˆØ¹</button>
</div>

</div>

<button id="add" onclick="newNote()">+</button>

<script>
let notes = JSON.parse(localStorage.getItem("notes") || "[]");
let current = null;
let currentColor = localStorage.getItem("lastColor") || "black";
let fontSize = parseInt(localStorage.getItem("fontSize") || "15");

const home = document.getElementById("home");
const editor = document.getElementById("editor");
const settings = document.getElementById("settings");
const list = document.getElementById("notesList");
const text = document.getElementById("text");
const title = document.getElementById("title");
const search = document.getElementById("search");
const colors = document.querySelectorAll(".color");

text.style.fontSize = fontSize + "px";

/* Ø§Ù„ØªÙ„ÙˆÙŠÙ† */
function activateColor(color){
    currentColor = color;
    localStorage.setItem("lastColor", color);
    colors.forEach(c=>c.classList.remove("active"));
    document.querySelector(`[data-color="${color}"]`).classList.add("active");
    document.execCommand("styleWithCSS", false, true);
    document.execCommand("foreColor", false, color);
}
colors.forEach(c=>c.onclick=()=>activateColor(c.dataset.color));

/* Ø§Ù„ØªØ®Ø²ÙŠÙ† */
function saveStorage(){
    localStorage.setItem("notes", JSON.stringify(notes));
}

/* Ø¹Ø±Ø¶ */
function render(){
    list.innerHTML="";
    notes.forEach((n,i)=>{
        if(n.title.includes(search.value) || n.content.includes(search.value)){
            let d=document.createElement("div");
            d.className="note";
            d.innerHTML=`<strong>${n.title}</strong><br><small>${n.date}</small>`;
            d.onclick=()=>editNote(i);
            list.appendChild(d);
        }
    });
}
search.oninput=render;

function newNote(){
    current=null;
    title.value="";
    text.innerHTML="";
    home.style.display="none";
    editor.style.display="block";
}

function editNote(i){
    current=i;
    title.value=notes[i].title;
    text.innerHTML=notes[i].content;
    home.style.display="none";
    editor.style.display="block";
}

function saveNote(){
    if(!title.value && !text.innerHTML) return;
    let note={
        title:title.value||"Ø¨Ø¯ÙˆÙ† Ø¹Ù†ÙˆØ§Ù†",
        content:text.innerHTML,
        date:new Date().toLocaleString()
    };
    current===null ? notes.push(note) : notes[current]=note;
    saveStorage();
    back();
}

function deleteNote(){
    if(current===null) return;
    if(confirm("Ù…ØªØ£ÙƒØ¯ ØªØ­Ø°ÙØŸ")){
        notes.splice(current,1);
        saveStorage();
        back();
    }
}

function deleteAll(){
    if(confirm("Ù…ØªØ£ÙƒØ¯ ØªØ­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø§ØªØŸ")){
        notes=[];
        saveStorage();
        render();
    }
}

function back(){
    editor.style.display="none";
    settings.style.display="none";
    home.style.display="block";
    render();
}

/* 3 Ù†Ù‚Ø§Ø· */
function toggleMenu(){
    menu.style.display = menu.style.display==="block"?"none":"block";
}

/* Ø§Ù„ÙˆØ¶Ø¹ Ø§Ù„Ù„ÙŠÙ„ÙŠ */
function toggleDark(){
    document.body.classList.toggle("dark");
    localStorage.setItem("dark",document.body.classList.contains("dark"));
}

/* Ø§Ù„Ø¥Ø¹Ø¯Ø§Ø¯Ø§Øª */
function openSettings(){
    home.style.display="none";
    editor.style.display="none";
    settings.style.display="block";
    menu.style.display="none";
}
function changeFont(v){
    fontSize += v;
    if(fontSize < 12) fontSize = 12;
    if(fontSize > 30) fontSize = 30;
    text.style.fontSize = fontSize + "px";
    localStorage.setItem("fontSize",fontSize);
}

/* Ø§Ù„Ø­Ù…Ø§ÙŠØ© */
function toggleLock(){
    lockBox.style.display = lockBox.style.display==="block"?"none":"block";
}
function savePin(){
    localStorage.setItem("pin",pin.value);
    alert("ØªÙ… Ø­ÙØ¸ Ø§Ù„Ø±Ù…Ø²");
}

/* Ù†Ø³Ø® Ø§Ø­ØªÙŠØ§Ø·ÙŠ Ø¯Ø§Ø®Ù„ÙŠ */
function backup(){
    localStorage.setItem("backupNotes", JSON.stringify(notes));
    alert("ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ Ù†Ø³Ø®Ø© Ø§Ø­ØªÙŠØ§Ø·ÙŠØ©");
}
function restore(){
    let b = localStorage.getItem("backupNotes");
    if(b){
        notes = JSON.parse(b);
        saveStorage();
        render();
        alert("ØªÙ… Ø§Ù„Ø§Ø³ØªØ±Ø¬Ø§Ø¹");
    }else{
        alert("Ù…Ø§ ÙƒØ§ÙŠÙ†Ø§Ø´ Ù†Ø³Ø®Ø©");
    }
}

/* Ø­ÙˆÙ„ */
function about(){
    alert("Ù…ÙÙƒØ±ØªÙŠ\nÙ†Ø³Ø®Ø© 1.0\nØªØ·Ø¨ÙŠÙ‚ Ù…ÙÙƒØ±Ø© Ø¨Ø¯ÙˆÙ† Ø¥Ù†ØªØ±Ù†Øª");
}

/* ØªØ´ØºÙŠÙ„ */
if(localStorage.getItem("dark")==="true"){
    document.body.classList.add("dark");
}
activateColor(currentColor);
render();
</script>

</body>
</html>
