<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<title>Ù…ÙÙƒØ±ØªÙŠ Ultimate</title>

<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>

<style>

body{
font-family:Arial;
margin:0;
background:#f0f0f0;
}

#topbar{
background:#2196f3;
padding:8px;
color:white;
}

button, select{
margin:2px;
padding:6px;
border:none;
cursor:pointer;
}

#toolbar{
background:#fff;
padding:5px;
display:none;
}

#editor{
background:#fff;
min-height:400px;
padding:10px;
outline:none;
}

table{
border-collapse:collapse;
width:100%;
}

td, th{
border:1px solid #999;
padding:8px;
}

#progress{
font-weight:bold;
color:green;
}

</style>

</head>
<body>

<div id="topbar">

<button onclick="newNote()">â• Ø¥Ø¶Ø§ÙØ©</button>

<button onclick="save()">ğŸ’¾ Ø­ÙØ¸</button>

<button onclick="templateWord()">ğŸ“„ Word</button>

<button onclick="templateTasks()">ğŸ“‹ Ù…Ù‡Ø§Ù…</button>

<button onclick="templateExcel()">ğŸ“Š Excel</button>

<button onclick="exportPDF()">ğŸ“„ PDF</button>

<select id="noteList" onchange="loadNote(this.value)"></select>

</div>


<div id="toolbar">

<button onclick="format('bold')"><b>B</b></button>

<button onclick="format('italic')"><i>I</i></button>

<button onclick="format('underline')"><u>U</u></button>

<button onclick="format('justifyLeft')">â¬…ï¸</button>

<button onclick="format('justifyCenter')">â¬œ</button>

<button onclick="format('justifyRight')">â¡ï¸</button>

<select onchange="fontSize(this.value)">
<option value="3">Ø¹Ø§Ø¯ÙŠ</option>
<option value="5">ÙƒØ¨ÙŠØ±</option>
<option value="7">Ø¶Ø®Ù…</option>
</select>

<input type="color" onchange="color(this.value)">

</div>


<div id="editor" contenteditable="true"></div>

<div id="progress"></div>


<script>

let editor=document.getElementById("editor");

let currentNote="";


// Word tools
function format(cmd){
document.execCommand(cmd,false,null);
}

function color(c){
document.execCommand("foreColor",false,c);
}

function fontSize(s){
document.execCommand("fontSize",false,s);
}


// new note
function newNote(){

let name=prompt("Ø§Ø³Ù… Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø©");

if(!name) return;

currentNote="note_"+name;

localStorage.setItem(currentNote,"");

editor.innerHTML="";

updateList();

}


// save
function save(){

if(!currentNote) return;

localStorage.setItem(currentNote,editor.innerHTML);

alert("ØªÙ… Ø§Ù„Ø­ÙØ¸");

updateList();

}


// load
function loadNote(name){

currentNote=name;

editor.innerHTML=localStorage.getItem(name)||"";

}


// update list
function updateList(){

let list=document.getElementById("noteList");

list.innerHTML="";

for(let i=0;i<localStorage.length;i++){

let key=localStorage.key(i);

if(key.startsWith("note_")){

let o=document.createElement("option");

o.value=key;

o.text=key.replace("note_","");

list.appendChild(o);

}

}

}


// WORD TEMPLATE
function templateWord(){

document.getElementById("toolbar").style.display="block";

editor.innerHTML="<h2>ÙˆØ«ÙŠÙ‚Ø© Word</h2><p>Ø§ÙƒØªØ¨ Ù‡Ù†Ø§...</p>";

}


// TASK TEMPLATE
function templateTasks(){

document.getElementById("toolbar").style.display="none";

editor.innerHTML=`

<h2>Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ù‡Ø§Ù…</h2>

<label><input type="checkbox" onclick="calcProgress()"> Ù…Ù‡Ù…Ø© 1</label><br>

<label><input type="checkbox" onclick="calcProgress()"> Ù…Ù‡Ù…Ø© 2</label><br>

<label><input type="checkbox" onclick="calcProgress()"> Ù…Ù‡Ù…Ø© 3</label><br>

`;

calcProgress();

}


// progress %
function calcProgress(){

let checks=editor.querySelectorAll("input[type=checkbox]");

let done=0;

checks.forEach(c=>{
if(c.checked) done++;
});

let percent=checks.length?Math.round(done/checks.length*100):0;

document.getElementById("progress").innerHTML="Ù†Ø³Ø¨Ø© Ø§Ù„Ø¥Ù†Ø¬Ø§Ø²: "+percent+"%";

}


// EXCEL TEMPLATE
function templateExcel(){

document.getElementById("toolbar").style.display="none";

editor.innerHTML=`

<h2>Ø¬Ø¯ÙˆÙ„ Excel</h2>

<table>

<tr>

<th>Ø§Ù„Ø¹Ù†ØµØ±</th>

<th>Ø§Ù„Ù‚ÙŠÙ…Ø©</th>

</tr>

<tr>

<td contenteditable="true">Ø¹Ù†ØµØ± 1</td>

<td contenteditable="true" oninput="sum()">0</td>

</tr>

<tr>

<td contenteditable="true">Ø¹Ù†ØµØ± 2</td>

<td contenteditable="true" oninput="sum()">0</td>

</tr>

<tr>

<th>Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹</th>

<th id="total">0</th>

</tr>

</table>

`;

}


// sum auto
function sum(){

let cells=editor.querySelectorAll("td[contenteditable=true]:nth-child(2)");

let total=0;

cells.forEach(c=>{

let val=parseFloat(c.innerText)||0;

total+=val;

});

let t=document.getElementById("total");

if(t) t.innerText=total;

}


// PDF
function exportPDF(){

if(!currentNote) return;

html2pdf().from(editor).save(currentNote+".pdf");

}


updateList();

</script>

</body>
</html>
