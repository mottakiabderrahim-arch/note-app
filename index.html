<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>Ù…ÙÙƒØ±ØªÙŠ Ø§Ù„Ø§Ø­ØªØ±Ø§ÙÙŠØ©</title>

<style>
:root{
    --bg:#f5f5f5;
    --card:#fff;
    --text:#000;
}
body.dark{
    --bg:#121212;
    --card:#1e1e1e;
    --text:#fff;
}

body{
    margin:0;
    font-family:sans-serif;
    background:var(--bg);
    color:var(--text);
}

#home,#editor,#lock{
    padding:10px;
}

.note{
    background:var(--card);
    padding:10px;
    margin-bottom:10px;
    border-radius:6px;
    cursor:pointer;
}

button,input,select{
    padding:10px;
    width:100%;
    margin-bottom:8px;
    font-size:16px;
}

#text{
    min-height:50vh;
    background:var(--card);
    border:1px solid #ccc;
    padding:10px;
    border-radius:6px;
}

#editor,#lock{display:none}

#actions{display:flex;gap:6px}
#actions button{flex:1}

#add{
    position:fixed;
    bottom:20px;
    right:20px;
    width:55px;
    height:55px;
    border-radius:50%;
    font-size:30px;
}

.color{
    width:25px;height:25px;border-radius:50%;display:inline-block;
    cursor:pointer;border:2px solid #999;
}
.color.active{border:3px solid #000}
</style>
</head>

<body>

<div id="lock">
    <h3>ğŸ”’ Ø£Ø¯Ø®Ù„ Ø§Ù„Ø±Ù…Ø²</h3>
    <input id="pinInput" type="password">
    <button onclick="unlock()">Ø¯Ø®ÙˆÙ„</button>
</div>

<div id="home">
    <input id="search" placeholder="Ø¨Ø­Ø«">
    <select id="sort">
        <option value="new">Ø§Ù„Ø£Ø­Ø¯Ø«</option>
        <option value="old">Ø§Ù„Ø£Ù‚Ø¯Ù…</option>
        <option value="title">Ø§Ù„Ø¹Ù†ÙˆØ§Ù†</option>
    </select>

    <button onclick="toggleDark()">ğŸŒ™ ÙˆØ¶Ø¹ Ù„ÙŠÙ„ÙŠ</button>
    <button onclick="showTrash()">ğŸ—‘ï¸ Ø³Ù„Ø© Ø§Ù„Ù…Ø­Ø°ÙˆÙØ§Øª</button>

    <div id="stats"></div>
    <div id="notesList"></div>
</div>

<div id="editor">
    <input id="title" placeholder="Ø§Ù„Ø¹Ù†ÙˆØ§Ù†">
    <input id="tag" placeholder="ØªØµÙ†ÙŠÙ">
    <div id="text" contenteditable="true"></div>

    <div>
        <span class="color" style="background:black" data-c="black"></span>
        <span class="color" style="background:red" data-c="red"></span>
        <span class="color" style="background:blue" data-c="blue"></span>
    </div>

    <div id="actions">
        <button onclick="save()">ğŸ’¾</button>
        <button onclick="fav()">â­</button>
        <button onclick="remove()">ğŸ—‘ï¸</button>
        <button onclick="back()">â†©</button>
    </div>

    <button onclick="exportTxt()">â¬‡ï¸ ØªØµØ¯ÙŠØ± TXT</button>
</div>

<button id="add" onclick="newNote()">+</button>

<script>
let notes = JSON.parse(localStorage.getItem("notes")||"[]");
let trash = JSON.parse(localStorage.getItem("trash")||"[]");
let pin = localStorage.getItem("pin") || "1234";
let current=null;

const home=document.getElementById("home");
const editor=document.getElementById("editor");
const lock=document.getElementById("lock");

function unlock(){
    if(pinInput.value===pin){
        lock.style.display="none";
        home.style.display="block";
    }
}

function saveStore(){
    localStorage.setItem("notes",JSON.stringify(notes));
    localStorage.setItem("trash",JSON.stringify(trash));
}

function newNote(){
    current=null;
    title.value="";
    tag.value="";
    text.innerHTML="";
    editor.style.display="block";
    home.style.display="none";
}

function save(){
    let n={
        title:title.value||"Ø¨Ø¯ÙˆÙ† Ø¹Ù†ÙˆØ§Ù†",
        tag:tag.value,
        content:text.innerHTML,
        fav:false,
        date:new Date().toLocaleString()
    };
    current===null?notes.push(n):notes[current]=n;
    saveStore();back();
}

function render(){
    notesList.innerHTML="";
    let arr=[...notes];
    if(sort.value==="title")arr.sort((a,b)=>a.title.localeCompare(b.title));
    if(sort.value==="old")arr.reverse();

    arr.forEach((n,i)=>{
        if(n.title.includes(search.value)||n.content.includes(search.value)){
            let d=document.createElement("div");
            d.className="note";
            d.innerHTML=`${n.fav?"â­ ":""}<b>${n.title}</b><br><small>${n.tag} | ${n.date}</small>`;
            d.onclick=()=>edit(i);
            notesList.appendChild(d);
        }
    });
    stats.innerHTML=`ğŸ“Š Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø§Øª: ${notes.length}`;
}

function edit(i){
    current=i;
    let n=notes[i];
    title.value=n.title;
    tag.value=n.tag;
    text.innerHTML=n.content;
    home.style.display="none";
    editor.style.display="block";
}

function fav(){
    if(current!=null){notes[current].fav=!notes[current].fav;saveStore();}
}

function remove(){
    if(current!=null){
        trash.push(notes[current]);
        notes.splice(current,1);
        saveStore();back();
    }
}

function showTrash(){
    notesList.innerHTML="";
    trash.forEach((n,i)=>{
        let d=document.createElement("div");
        d.className="note";
        d.innerHTML=`ğŸ—‘ï¸ ${n.title}`;
        d.onclick=()=>{notes.push(n);trash.splice(i,1);saveStore();render();}
        notesList.appendChild(d);
    });
}

function exportTxt(){
    let blob=new Blob([text.innerText],{type:"text/plain"});
    let a=document.createElement("a");
    a.href=URL.createObjectURL(blob);
    a.download="note.txt";
    a.click();
}

function toggleDark(){
    document.body.classList.toggle("dark");
}

function back(){
    editor.style.display="none";
    home.style.display="block";
    render();
}

sort.onchange=render;
search.oninput=render;

lock.style.display="block";
render();
</script>

</body>
</html>
