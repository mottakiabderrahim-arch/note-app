<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>Ù…ÙÙƒØ±ØªÙŠ</title>

<style>
:root{
  --bg:#f2f2f2;
  --card:#ffffff;
  --text:#000000;
  --main:#2196f3;
}

body.dark{
  --bg:#121212;
  --card:#1e1e1e;
  --text:#ffffff;
  --main:#333333;
}

body{
  margin:0;
  font-family:Arial;
  background:var(--bg);
  color:var(--text);
}

/* Ø´Ø§Ø´Ø© Ø§Ù„Ù‚ÙÙ„ */
#lockScreen{
  position:fixed;
  top:0;
  left:0;
  width:100%;
  height:100%;
  background:#121212;
  display:flex;
  flex-direction:column;
  justify-content:center;
  align-items:center;
  z-index:9999;
}

header{
  background:var(--main);
  color:white;
  padding:15px;
  text-align:center;
  font-size:20px;
  position:relative;
}

.darkBtn{
  position:absolute;
  left:15px;
  top:12px;
  background:white;
  color:black;
  border:none;
  padding:5px 10px;
}

.container{
  padding:15px;
}

textarea,input,select,button{
  width:100%;
  padding:8px;
  margin-top:8px;
  box-sizing:border-box;
}

button{
  background:var(--main);
  color:white;
  border:none;
}

.note{
  padding:10px;
  margin-top:10px;
  border-radius:5px;
  position:relative;
}

.smallBtn{
  position:absolute;
  top:5px;
  border:none;
  padding:3px 6px;
  font-size:12px;
  cursor:pointer;
}

</style>
</head>
<body>

<div id="lockScreen">
  <h2 style="color:white;">ğŸ”’ Ø£Ø¯Ø®Ù„ Ø§Ù„Ø±Ù…Ø²</h2>
  <input type="password" id="pinInput">
  <button onclick="checkPin()">Ø¯Ø®ÙˆÙ„</button>
</div>

<header>
Ù…ÙÙƒØ±ØªÙŠ
<button class="darkBtn" onclick="toggleDark()">ğŸŒ™</button>
</header>

<div class="container">

<textarea id="noteInput" placeholder="Ø§ÙƒØªØ¨ Ù…Ù„Ø§Ø­Ø¸ØªÙƒ..."></textarea>

<select id="categorySelect">
<option value="Ø´Ø®ØµÙŠ">Ø´Ø®ØµÙŠ</option>
<option value="Ø¯Ø±Ø§Ø³Ø©">Ø¯Ø±Ø§Ø³Ø©</option>
<option value="Ø¹Ù…Ù„">Ø¹Ù…Ù„</option>
</select>

<button onclick="addNote()">Ø¥Ø¶Ø§ÙØ©</button>

<input type="text" id="searchInput" placeholder="Ø¨Ø­Ø«..." onkeyup="displayNotes()">

<select id="filterCategory" onchange="displayNotes()">
<option value="all">ÙƒÙ„ Ø§Ù„ØªØµÙ†ÙŠÙØ§Øª</option>
<option value="Ø´Ø®ØµÙŠ">Ø´Ø®ØµÙŠ</option>
<option value="Ø¯Ø±Ø§Ø³Ø©">Ø¯Ø±Ø§Ø³Ø©</option>
<option value="Ø¹Ù…Ù„">Ø¹Ù…Ù„</option>
</select>

<select id="sortSelect" onchange="displayNotes()">
<option value="new">Ø§Ù„Ø£Ø­Ø¯Ø« Ø£ÙˆÙ„Ø§Ù‹</option>
<option value="old">Ø§Ù„Ø£Ù‚Ø¯Ù… Ø£ÙˆÙ„Ø§Ù‹</option>
</select>

<button onclick="deleteAll()" style="background:red;">ğŸ—‘ï¸ Ø­Ø°Ù Ø§Ù„ÙƒÙ„</button>

<div id="stats"></div>
<div id="notesContainer"></div>

</div>

<script>

// ===== Ø§Ù„Ù‚ÙÙ„ =====
let savedPin = localStorage.getItem("appPin");
if(!savedPin){
  let newPin = prompt("Ø£Ù†Ø´Ø¦ Ø±Ù…Ø² Ø³Ø±ÙŠ:");
  if(newPin){
    localStorage.setItem("appPin", newPin);
    savedPin = newPin;
  }
}

function checkPin(){
  let input = document.getElementById("pinInput").value;
  if(input === savedPin){
    document.getElementById("lockScreen").style.display="none";
  }else{
    alert("Ø±Ù…Ø² Ø®Ø§Ø·Ø¦");
  }
}

// ===== Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª =====
let notes = JSON.parse(localStorage.getItem("notes")) || [];

function addNote(){
  let input = document.getElementById("noteInput");
  let category = document.getElementById("categorySelect").value;
  if(input.value.trim()==="") return;

  notes.push({
    text: input.value,
    date: new Date().toLocaleString(),
    pinned:false,
    color:"#ffffff",
    done:false,
    category:category
  });

  localStorage.setItem("notes",JSON.stringify(notes));
  input.value="";
  displayNotes();
}

function displayNotes(){
  let container=document.getElementById("notesContainer");
  let search=document.getElementById("searchInput").value.toLowerCase();
  let filter=document.getElementById("filterCategory").value;
  let sort=document.getElementById("sortSelect").value;

  container.innerHTML="";

  let total=0, doneCount=0;

  let copy=[...notes];
  copy.sort((a,b)=>b.pinned-a.pinned);
  if(sort==="new") copy.reverse();

  copy.forEach(note=>{
    if(
      note.text.toLowerCase().includes(search) &&
      (filter==="all" || note.category===filter)
    ){

      total++;
      if(note.done) doneCount++;

      let div=document.createElement("div");
      div.className="note";
      div.style.background=note.color;

      let check=document.createElement("input");
      check.type="checkbox";
      check.checked=note.done;
      check.onchange=function(){
        note.done=this.checked;
        localStorage.setItem("notes",JSON.stringify(notes));
        displayNotes();
      };

      let text=document.createElement("div");
      text.textContent=note.text;
      if(note.done){
        text.style.textDecoration="line-through";
        text.style.opacity="0.6";
      }

      let date=document.createElement("small");
      date.textContent=note.date;
      date.style.display="block";

      let cat=document.createElement("small");
      cat.textContent="ğŸ“‚ "+note.category;
      cat.style.display="block";

      let pin=document.createElement("button");
      pin.textContent=note.pinned?"â­":"â˜†";
      pin.className="smallBtn";
      pin.style.left="5px";
      pin.onclick=function(){
        note.pinned=!note.pinned;
        localStorage.setItem("notes",JSON.stringify(notes));
        displayNotes();
      };

      let edit=document.createElement("button");
      edit.textContent="âœï¸";
      edit.className="smallBtn";
      edit.style.left="35px";
      edit.onclick=function(){
        let newText=prompt("Ø¹Ø¯Ù„:",note.text);
        if(newText){
          note.text=newText;
          localStorage.setItem("notes",JSON.stringify(notes));
          displayNotes();
        }
      };

      let del=document.createElement("button");
      del.textContent="ğŸ—‘ï¸";
      del.className="smallBtn";
      del.style.left="65px";
      del.onclick=function(){
        notes.splice(notes.indexOf(note),1);
        localStorage.setItem("notes",JSON.stringify(notes));
        displayNotes();
      };

      let color=document.createElement("input");
      color.type="color";
      color.value=note.color;
      color.className="smallBtn";
      color.style.left="95px";
      color.onchange=function(){
        note.color=this.value;
        localStorage.setItem("notes",JSON.stringify(notes));
        displayNotes();
      };

      div.append(check,text,date,cat,pin,edit,del,color);
      container.appendChild(div);
    }
  });

  document.getElementById("stats").textContent=
  "ğŸ“Š Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹: "+total+" | âœ… Ø§Ù„Ù…Ù†Ø¬Ø²Ø©: "+doneCount;
}

function deleteAll(){
  if(confirm("Ù…Ø³Ø­ Ø§Ù„ÙƒÙ„ØŸ")){
    notes=[];
    localStorage.setItem("notes",JSON.stringify(notes));
    displayNotes();
  }
}

function toggleDark(){
  document.body.classList.toggle("dark");
  localStorage.setItem("darkMode",
    document.body.classList.contains("dark")?"on":"off"
  );
}

if(localStorage.getItem("darkMode")==="on"){
  document.body.classList.add("dark");
}

displayNotes();

</script>
</body>
</html>
