<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>Ù…ÙÙƒØ±ØªÙŠ</title>

<style>
:root{
  --bg:#f5f5f5;
  --card:#fff;
  --text:#000;
  --main:#2196f3;
}
body.dark{
  --bg:#121212;
  --card:#1e1e1e;
  --text:#fff;
}
body{
  margin:0;
  font-family:sans-serif;
  background:var(--bg);
  color:var(--text);
}
header{
  background:var(--main);
  color:#fff;
  padding:12px;
  text-align:center;
  font-size:18px;
  position:relative;
}
.menu-btn{
  position:absolute;
  left:10px;
  top:10px;
  cursor:pointer;
}
.menu{
  display:none;
  position:absolute;
  left:10px;
  top:45px;
  background:var(--card);
  border-radius:6px;
  box-shadow:0 2px 6px rgba(0,0,0,.3);
  z-index:10;
}
.menu div{
  padding:10px;
  border-bottom:1px solid #ccc;
  cursor:pointer;
}
.menu div:last-child{border:none}

#container{padding:10px}

input,button{
  width:100%;
  padding:8px;
  margin-top:6px;
  border-radius:6px;
  border:1px solid #ccc;
  box-sizing:border-box;
}
button{
  background:var(--main);
  color:#fff;
  border:none;
}

.toolbar button{
  width:auto;
  margin:2px;
}

#editor{
  min-height:120px;
  border:1px solid #ccc;
  border-radius:6px;
  padding:8px;
  margin-top:6px;
  background:#fff;
}

.note{
  background:var(--card);
  margin-top:10px;
  padding:10px;
  border-radius:6px;
  position:relative;
}
.note-title{
  font-weight:bold;
  margin-bottom:6px;
}
.delete{
  position:absolute;
  left:10px;
  top:10px;
  cursor:pointer;
}
</style>
</head>

<body>

<header>
  <span class="menu-btn" onclick="toggleMenu()">â‹®</span>
  ğŸ“’ Ù…ÙÙƒØ±ØªÙŠ
  <div class="menu" id="menu">
    <div onclick="toggleDark()">ğŸŒ™ ÙˆØ¶Ø¹ Ù„ÙŠÙ„ÙŠ</div>
    <div onclick="toggleOrder()">â†•ï¸ ØªØ±ØªÙŠØ¨</div>
    <div onclick="deleteAll()">ğŸ—‘ï¸ Ø­Ø°Ù Ø§Ù„ÙƒÙ„</div>
  </div>
</header>

<div id="container">
  <input id="search" placeholder="ğŸ” Ø¨Ø­Ø«..." onkeyup="showNotes()">
  <input id="title" placeholder="ğŸ“ Ø¹Ù†ÙˆØ§Ù† Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø©">

  <!-- Toolbar -->
  <div class="toolbar">
    <button onclick="cmd('bold')"><b>B</b></button>
    <button onclick="cmd('italic')"><i>I</i></button>
    <button onclick="cmd('underline')"><u>U</u></button>
    <button onclick="colorText('red')">ğŸ”´</button>
    <button onclick="colorText('blue')">ğŸ”µ</button>
    <button onclick="colorText('green')">ğŸŸ¢</button>
    <button onclick="openImage()">ğŸ–¼ï¸</button>
    <input type="file" id="imgInput" accept="image/*" style="display:none">
  </div>

  <div id="editor" contenteditable="true">Ø§ÙƒØªØ¨ Ù…Ù„Ø§Ø­Ø¸ØªÙƒ Ù‡Ù†Ø§...</div>

  <button onclick="saveNote()">ğŸ’¾ Ø­ÙØ¸</button>

  <div id="notes"></div>
</div>

<script>
let notes = JSON.parse(localStorage.getItem("notes")||"[]");
let editIndex = -1;
let newestFirst = true;

const title = document.getElementById("title");
const editor = document.getElementById("editor");
const notesBox = document.getElementById("notes");
const menu = document.getElementById("menu");

/* ===== Menu ===== */
function toggleMenu(){
  menu.style.display = menu.style.display==="block"?"none":"block";
}

/* ===== Dark Mode ===== */
function toggleDark(){
  document.body.classList.toggle("dark");
  localStorage.setItem("dark",
    document.body.classList.contains("dark"));
}
if(localStorage.getItem("dark")==="true"){
  document.body.classList.add("dark");
}

/* ===== Order ===== */
function toggleOrder(){
  newestFirst = !newestFirst;
  showNotes();
}

/* ===== execCommand (Ù…Ø­Ø¯ÙˆØ¯) ===== */
function cmd(c){
  document.execCommand(c,false,null);
}

/* ===== Coloring (SPAN Ø¢Ù…Ù†) ===== */
function colorText(color){
  let sel = window.getSelection();
  if(!sel.rangeCount) return;
  let range = sel.getRangeAt(0);
  let span = document.createElement("span");
  span.style.color = color;
  range.surroundContents(span);
}

/* ===== Images (ØµÙˆØ±Ø© ÙˆØ­Ø¯Ø© + Ø­Ø¬Ù… Ù…Ø­Ø¯ÙˆØ¯) ===== */
function openImage(){
  document.getElementById("imgInput").click();
}
document.getElementById("imgInput").onchange=function(){
  let file=this.files[0];
  if(!file) return;
  if(file.size > 300000){
    alert("âš ï¸ Ø§Ù„ØµÙˆØ±Ø© ÙƒØ¨ÙŠØ±Ø© Ø¨Ø²Ø§Ù");
    return;
  }
  let reader=new FileReader();
  reader.onload=function(){
    editor.innerHTML +=
      `<img src="${reader.result}" style="max-width:100%;display:block;margin:6px 0">`;
  }
  reader.readAsDataURL(file);
}

/* ===== Notes ===== */
function saveNote(){
  let t = title.value.trim();
  let html = editor.innerHTML.trim();
  if(!t && !html) return;

  let note={title:t||"Ø¨Ø¯ÙˆÙ† Ø¹Ù†ÙˆØ§Ù†", html};

  if(editIndex===-1) notes.push(note);
  else{ notes[editIndex]=note; editIndex=-1; }

  localStorage.setItem("notes",JSON.stringify(notes));
  title.value="";
  editor.innerHTML="";
  showNotes();
}

function showNotes(){
  notesBox.innerHTML="";
  let q=document.getElementById("search").value.toLowerCase();
  let arr=[...notes];
  if(newestFirst) arr.reverse();

  arr.forEach((n,i)=>{
    if(!(n.title+n.html).toLowerCase().includes(q)) return;
    let d=document.createElement("div");
    d.className="note";
    d.innerHTML=`
      <span class="delete" onclick="del(${i});event.stopPropagation()">ğŸ—‘ï¸</span>
      <div class="note-title">${n.title}</div>
      <div>${n.html}</div>`;
    d.onclick=()=>{
      title.value=n.title;
      editor.innerHTML=n.html;
      editIndex=i;
      window.scrollTo(0,0);
    };
    notesBox.appendChild(d);
  });
}

function del(i){
  if(confirm("Ø­Ø°Ù Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø©ØŸ")){
    notes.splice(i,1);
    localStorage.setItem("notes",JSON.stringify(notes));
    showNotes();
  }
}

function deleteAll(){
  if(confirm("Ø­Ø°Ù Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ù„Ø§Ø­Ø¸Ø§ØªØŸ")){
    notes=[];
    localStorage.removeItem("notes");
    showNotes();
  }
}

showNotes();
</script>

</body>
</html>
