<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>Ù…ÙÙƒØ±ØªÙŠ Pro+</title>

<!-- icons -->
<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

<!-- pdf -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>

<style>

:root{
 --bg:#f2f2f2;
 --card:#fff;
 --text:#000;
 --main:#2196f3;
}

body.dark{
 --bg:#121212;
 --card:#1e1e1e;
 --text:#fff;
}

body{
 margin:0;
 font-family:Arial;
 background:var(--bg);
 color:var(--text);
}

header{
 background:var(--main);
 color:#fff;
 padding:12px;
 display:flex;
 justify-content:space-between;
 align-items:center;
}

.icon{
 cursor:pointer;
 padding:5px;
}

.container{
 padding:10px;
}

textarea, input{
 width:100%;
 padding:10px;
 margin:5px 0;
}

button{
 background:var(--main);
 color:#fff;
 border:none;
 padding:6px 10px;
 margin:3px;
 cursor:pointer;
 border-radius:4px;
}

.note{
 background:var(--card);
 padding:10px;
 margin-top:10px;
 border-radius:6px;
}

.date{
 font-size:12px;
 opacity:0.6;
}

.menu{
 position:fixed;
 top:50px;
 left:10px;
 background:var(--card);
 border-radius:6px;
 display:none;
 padding:5px;
 box-shadow:0 0 5px rgba(0,0,0,0.3);
}

.menu div{
 padding:8px;
 cursor:pointer;
}

.menu div:hover{
 background:#ddd;
}

</style>
</head>

<body>

<header>

<span>ğŸ“’ Ù…ÙÙƒØ±ØªÙŠ Pro+</span>

<span class="material-icons icon" onclick="toggleMenu()">more_vert</span>

</header>

<div class="menu" id="menu">

<div onclick="toggleDark()">
<span class="material-icons">dark_mode</span>
 ÙˆØ¶Ø¹ Ù„ÙŠÙ„ÙŠ
</div>

<div onclick="backup()">
<span class="material-icons">backup</span>
 Backup
</div>

<div onclick="restore()">
<span class="material-icons">restore</span>
 Restore
</div>

</div>

<div class="container">

<input id="search" placeholder="ğŸ” Ø¨Ø­Ø«..." oninput="loadNotes()">

<textarea id="input" placeholder="Ø§ÙƒØªØ¨ Ù…Ù„Ø§Ø­Ø¸Ø©..."></textarea>

<input type="datetime-local" id="reminder">

<button onclick="addNote()">
<span class="material-icons">add</span>
 Ø¥Ø¶Ø§ÙØ©
</button>

<div id="notes"></div>

</div>

<script>

let notes = JSON.parse(localStorage.getItem("notes")||"[]");

function save(){
 localStorage.setItem("notes", JSON.stringify(notes));
}

function toggleMenu(){

 let m=document.getElementById("menu");

 m.style.display=
 m.style.display=="block"?"none":"block";
}

function toggleDark(){

 document.body.classList.toggle("dark");
}

function addNote(){

 let text=input.value;
 let reminder=document.getElementById("reminder").value;

 if(!text) return;

 notes.unshift({

  text,
  date:new Date().toLocaleString(),
  reminder,
  alerted:false

 });

 save();
 loadNotes();

 input.value="";
}

function deleteNote(i){

 notes.splice(i,1);
 save();
 loadNotes();
}

function editNote(i){

 let t=prompt("ØªØ¹Ø¯ÙŠÙ„:",notes[i].text);

 if(t){

 notes[i].text=t;
 save();
 loadNotes();

 }
}

function exportPDF(i){

 let note=notes[i];

 let element=document.createElement("div");

 element.innerHTML=
 `
 <h2>Ù…Ù„Ø§Ø­Ø¸Ø©</h2>
 <hr>
 <p>${note.text}</p>
 <hr>
 <small>${note.date}</small>
 `;

 html2pdf()
 .set({
  margin:10,
  filename:"note.pdf",
  html2canvas:{scale:2},
  jsPDF:{unit:"mm", format:"a4"}
 })
 .from(element)
 .save();
}

function backup(){

 let data=JSON.stringify(notes);

 let blob=new Blob([data]);

 let a=document.createElement("a");

 a.href=URL.createObjectURL(blob);

 a.download="backup.notes";

 a.click();
}

function restore(){

 let input=document.createElement("input");

 input.type="file";

 input.onchange=e=>{

  let file=e.target.files[0];

  let reader=new FileReader();

  reader.onload=function(){

   notes=JSON.parse(reader.result);

   save();
   loadNotes();

  }

  reader.readAsText(file);

 }

 input.click();
}

function loadNotes(){

 let s=search.value.toLowerCase();

 let html="";

 notes.forEach((n,i)=>{

 if(!n.text.toLowerCase().includes(s)) return;

 html+=`
 <div class="note">

 ${n.text}

 <div class="date">${n.date}</div>

 <button onclick="editNote(${i})">
 <span class="material-icons">edit</span>
 </button>

 <button onclick="deleteNote(${i})">
 <span class="material-icons">delete</span>
 </button>

 <button onclick="exportPDF(${i})">
 <span class="material-icons">picture_as_pdf</span>
 </button>

 </div>
 `;

 if(n.reminder){

  let now=Date.now();

  let r=new Date(n.reminder).getTime();

  if(now>=r && !n.alerted){

   alert("â° ØªØ°ÙƒÙŠØ±:\n"+n.text);

   n.alerted=true;
   save();

  }

 }

 });

 notes.innerHTML=html;

 document.getElementById("notes").innerHTML=html;
}

loadNotes();

setInterval(loadNotes,5000);

</script>

</body>
</html>
