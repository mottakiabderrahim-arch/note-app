<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>Ù…ÙÙƒØ±ØªÙŠ</title>

<style>
:root{
  --bg:#f2f2f2;
  --card:#ffffff;
  --text:#000000;
  --main:#2196f3;
}

body.dark{
  --bg:#121212;
  --card:#1e1e1e;
  --text:#ffffff;
  --main:#333333;
}

body{
  margin:0;
  font-family:Arial;
  background:var(--bg);
  color:var(--text);
}

#lockScreen{
  position:fixed;
  top:0;
  left:0;
  width:100%;
  height:100%;
  background:#121212;
  display:flex;
  flex-direction:column;
  justify-content:center;
  align-items:center;
  z-index:9999;
}

header{
  background:var(--main);
  color:white;
  padding:15px;
  text-align:center;
  font-size:20px;
  position:relative;
}

.darkBtn{
  position:absolute;
  left:15px;
  top:12px;
  background:white;
  color:black;
  border:none;
  padding:5px 10px;
}

.container{ padding:15px; }

textarea,input,select,button{
  width:100%;
  padding:8px;
  margin-top:8px;
  box-sizing:border-box;
}

button{
  background:var(--main);
  color:white;
  border:none;
  cursor:pointer;
}

.note{
  padding:10px;
  margin-top:10px;
  border-radius:8px;
  position:relative;
  background:var(--card);
}

.menuBtn{
  position:absolute;
  top:5px;
  left:5px;
  background:none;
  border:none;
  font-size:20px;
  cursor:pointer;
}

.noteMenu{
  position:absolute;
  top:30px;
  left:5px;
  background:white;
  border:1px solid #ccc;
  border-radius:6px;
  box-shadow:0 2px 8px rgba(0,0,0,0.2);
  display:none;
  z-index:100;
}

.noteMenu button{
  width:100%;
  background:none;
  color:black;
  border:none;
  padding:6px;
  text-align:right;
}

.noteMenu button:hover{
  background:#f0f0f0;
}
</style>
</head>
<body>

<div id="lockScreen">
  <h2 style="color:white;">ğŸ”’ Ø£Ø¯Ø®Ù„ Ø§Ù„Ø±Ù…Ø²</h2>
  <input type="password" id="pinInput">
  <button onclick="checkPin()">Ø¯Ø®ÙˆÙ„</button>
</div>

<header>
Ù…ÙÙƒØ±ØªÙŠ
<button class="darkBtn" onclick="toggleDark()">ğŸŒ™</button>
</header>

<div class="container">

<textarea id="noteInput" placeholder="Ø§ÙƒØªØ¨ Ù…Ù„Ø§Ø­Ø¸ØªÙƒ..."></textarea>

<select id="categorySelect">
<option value="Ø´Ø®ØµÙŠ">Ø´Ø®ØµÙŠ</option>
<option value="Ø¯Ø±Ø§Ø³Ø©">Ø¯Ø±Ø§Ø³Ø©</option>
<option value="Ø¹Ù…Ù„">Ø¹Ù…Ù„</option>
</select>

<button onclick="addNote()">Ø¥Ø¶Ø§ÙØ©</button>

<input type="text" id="searchInput" placeholder="Ø¨Ø­Ø«..." onkeyup="displayNotes()">

<select id="filterCategory" onchange="displayNotes()">
<option value="all">ÙƒÙ„ Ø§Ù„ØªØµÙ†ÙŠÙØ§Øª</option>
<option value="Ø´Ø®ØµÙŠ">Ø´Ø®ØµÙŠ</option>
<option value="Ø¯Ø±Ø§Ø³Ø©">Ø¯Ø±Ø§Ø³Ø©</option>
<option value="Ø¹Ù…Ù„">Ø¹Ù…Ù„</option>
</select>

<select id="sortSelect" onchange="displayNotes()">
<option value="new">Ø§Ù„Ø£Ø­Ø¯Ø« Ø£ÙˆÙ„Ø§Ù‹</option>
<option value="old">Ø§Ù„Ø£Ù‚Ø¯Ù… Ø£ÙˆÙ„Ø§Ù‹</option>
</select>

<button onclick="deleteAll()" style="background:red;">ğŸ—‘ï¸ Ø­Ø°Ù Ø§Ù„ÙƒÙ„</button>

<div id="stats"></div>
<div id="notesContainer"></div>

</div>

<script>

// ===== Ø§Ù„Ù‚ÙÙ„ =====
let savedPin = localStorage.getItem("appPin");
if(!savedPin){
  let newPin = prompt("Ø£Ù†Ø´Ø¦ Ø±Ù…Ø² Ø³Ø±ÙŠ:");
  if(newPin){
    localStorage.setItem("appPin", newPin);
    savedPin = newPin;
  }
}

function checkPin(){
  let input = document.getElementById("pinInput").value;
  if(input === savedPin){
    document.getElementById("lockScreen").style.display="none";
  }else{
    alert("Ø±Ù…Ø² Ø®Ø§Ø·Ø¦");
  }
}

// ===== Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª =====
let notes = JSON.parse(localStorage.getItem("notes")) || [];

function addNote(){
  let input = document.getElementById("noteInput");
  let category = document.getElementById("categorySelect").value;
  if(input.value.trim()==="") return;

  notes.push({
    text: input.value,
    date: Date.now(),
    pinned:false,
    color:"#ffffff",
    done:false,
    category:category
  });

  localStorage.setItem("notes",JSON.stringify(notes));
  input.value="";
  displayNotes();
}

function displayNotes(){
  let container=document.getElementById("notesContainer");
  let search=document.getElementById("searchInput").value.toLowerCase();
  let filter=document.getElementById("filterCategory").value;
  let sort=document.getElementById("sortSelect").value;

  container.innerHTML="";
  let total=0, doneCount=0;

  let copy=[...notes];

  copy.sort((a,b)=>{
    if(a.pinned !== b.pinned) return b.pinned - a.pinned;
    return sort==="new" ? b.date - a.date : a.date - b.date;
  });

  copy.forEach(note=>{
    if(
      note.text.toLowerCase().includes(search) &&
      (filter==="all" || note.category===filter)
    ){

      total++;
      if(note.done) doneCount++;

      let div=document.createElement("div");
      div.className="note";
      div.style.background=note.color;

      let menuBtn=document.createElement("button");
      menuBtn.textContent="â‹®";
      menuBtn.className="menuBtn";

      let menu=document.createElement("div");
      menu.className="noteMenu";

      menu.innerHTML=`
      <button onclick="toggleDone(${notes.indexOf(note)})">âœ… Ù…Ù†Ø¬Ø²</button>
      <button onclick="togglePin(${notes.indexOf(note)})">â­ ØªØ«Ø¨ÙŠØª</button>
      <button onclick="editNote(${notes.indexOf(note)})">âœï¸ ØªØ¹Ø¯ÙŠÙ„</button>
      <button onclick="deleteNote(${notes.indexOf(note)})">ğŸ—‘ï¸ Ø­Ø°Ù</button>
      <button onclick="changeColor(${notes.indexOf(note)})">ğŸ¨ Ù„ÙˆÙ†</button>
      `;

      menuBtn.onclick=function(e){
        e.stopPropagation();
        document.querySelectorAll(".noteMenu").forEach(m=>m.style.display="none");
        menu.style.display="block";
      };

      document.addEventListener("click",function(){
        menu.style.display="none";
      });

      let text=document.createElement("div");
      text.textContent=note.text;
      if(note.done){
        text.style.textDecoration="line-through";
        text.style.opacity="0.6";
      }

      let date=document.createElement("small");
      date.textContent=new Date(note.date).toLocaleString();
      date.style.display="block";

      let cat=document.createElement("small");
      cat.textContent="ğŸ“‚ "+note.category;
      cat.style.display="block";

      div.append(menuBtn,menu,text,date,cat);
      container.appendChild(div);
    }
  });

  document.getElementById("stats").textContent=
  "ğŸ“Š Ø§Ù„Ù…Ø¬Ù…ÙˆØ¹: "+total+" | âœ… Ø§Ù„Ù…Ù†Ø¬Ø²Ø©: "+doneCount;
}

// ===== Ø§Ù„Ø¹Ù…Ù„ÙŠØ§Øª =====

function toggleDone(i){
  notes[i].done=!notes[i].done;
  save();
}

function togglePin(i){
  notes[i].pinned=!notes[i].pinned;
  save();
}

function editNote(i){
  let newText=prompt("Ø¹Ø¯Ù„:",notes[i].text);
  if(newText){
    notes[i].text=newText;
    save();
  }
}

function deleteNote(i){
  if(confirm("Ø­Ø°ÙØŸ")){
    notes.splice(i,1);
    save();
  }
}

function changeColor(i){
  let color=prompt("Ø£Ø¯Ø®Ù„ Ù„ÙˆÙ† (Ù…Ø«Ø§Ù„: #ffcc00)");
  if(color){
    notes[i].color=color;
    save();
  }
}

function deleteAll(){
  if(confirm("Ù…Ø³Ø­ Ø§Ù„ÙƒÙ„ØŸ")){
    notes=[];
    save();
  }
}

function save(){
  localStorage.setItem("notes",JSON.stringify(notes));
  displayNotes();
}

function toggleDark(){
  document.body.classList.toggle("dark");
  localStorage.setItem("darkMode",
    document.body.classList.contains("dark")?"on":"off"
  );
}

if(localStorage.getItem("darkMode")==="on"){
  document.body.classList.add("dark");
}

displayNotes();

</script>
</body>
</html>
